<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="./styles/vant.css">
    <title>订单历史</title>
</head>

<body>
    <div id="app">
        <van-nav-bar title="订单历史"></van-nav-bar>
        <van-steps direction="vertical" :active="tracks.length-1">
            <van-step v-for="track in tracks">
                <h3>{{track.action}}</h3>
                <p>{{track.time}}</p>
            </van-step>
        </van-steps>
        <van-button type="primary" @click="closeWindow" style="width: 100%;">关闭</van-button>
    </div>
</body>
<!-- 引入 Vue 和 Vant 的 JS 文件 -->
<script type="text/javascript" src="./libs/vue.min.js"></script>
<script type="text/javascript" src="./libs/vant.min.js"></script>
<script type="text/javascript" src="./libs/axios.min.js"></script>
<script type="text/javascript" src="./libs/jweixin-1.2.0.js"></script>
<script type="text/javascript" src="./libs/common.js"></script>
<script>
    const referredid = getParamValue(window.location.href, 'referredid');
    const app = new Vue({
        el: "#app",
        //router,
        data: () => {
            return {
                tracks: []
            }
        },
        mounted: function () {
            //getTicket().then(r => this.operator = r);
            getReferred(referredid).then(r => {
                const act = new Map([
                    ["new", " 新建信息"],
                    ["dispatch", "指派顾问"],
                    ["accept", "接受指派"],
                    ["commit", "跟进报告"],
                    ["success", "订单成交"],
                    ["fail", "订单战败"]
                ]);
                //console.log(r);
                this.tracks = r.tracks.map(item => {
                    return {
                        action: act.get(item.action),
                        time: item.update_time
                    }
                });
            });
        },
        methods: {
            closeWindow() {
                wx.closeWindow();
            }
        }
    });
</script>

</html>